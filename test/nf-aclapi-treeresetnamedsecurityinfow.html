<!doctype html>
<html class="layout layout-holy-grail   show-table-of-contents conceptual show-breadcrumb default-focus" lang="en-us" dir="ltr" data-authenticated="false" data-auth-status-determined="false" data-target="docs" x-ms-format-detection="none">
  <head>
    <title>TreeResetNamedSecurityInfoW function (aclapi.h) - Win32 apps | Microsoft Learn</title>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta name="color-scheme" content="light dark"/>
    <meta name="description" content="Resets specified security information in the security descriptor of a specified tree of objects. (Unicode)"/>
    <link rel="canonical" href="https://learn.microsoft.com/en-us/windows/win32/api/aclapi/nf-aclapi-treeresetnamedsecurityinfow"/>
    <!-- Non-customizable open graph and sharing-related metadata -->
    <meta name="twitter:card" content="summary_large_image"/>
    <meta name="twitter:site" content="@MicrosoftLearn"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image:alt" content="Microsoft Learn"/>
    <meta property="og:image" content="https://learn.microsoft.com/en-us/media/open-graph-image.png"/>
    <!-- Page specific open graph and sharing-related metadata -->
    <meta property="og:title" content="TreeResetNamedSecurityInfoW function (aclapi.h) - Win32 apps"/>
    <meta property="og:url" content="https://learn.microsoft.com/en-us/windows/win32/api/aclapi/nf-aclapi-treeresetnamedsecurityinfow"/>
    <meta property="og:description" content="Resets specified security information in the security descriptor of a specified tree of objects. (Unicode)"/>
    <meta name="platform_id" content="97eb41ef-c571-c77d-0eb9-1dc2041d7cc2"/>
    <meta name="scope" content="Windows"/>
    <meta name="scope" content="Desktop"/>
    <meta name="locale" content="en-us"/>
    <meta name="adobe-target" content="true"/>
    <meta name="uhfHeaderId" content="MSDocsHeader-WinDevCenter"/>
    <meta name="page_type" content="conceptual"/>
    <!--page specific meta tags-->
    <!-- custom meta tags -->
    <meta name="breadcrumb_path" content="/windows/desktop/api/breadcrumb/toc.json"/>
    <meta name="ms.service" content="windows-api-desktop-tech"/>
    <meta name="ms.subservice" content="sdk-api-reference"/>
    <meta name="ms.topic" content="reference"/>
    <meta name="ms.author" content="aashcraft"/>
    <meta name="author" content="alvinashcraft"/>
    <meta name="feedback_system" content="Standard"/>
    <meta name="feedback_product_url" content="https://www.microsoft.com/en-us/windowsinsider/feedbackhub/fb"/>
    <meta name="feedback_help_link_url" content="https://learn.microsoft.com/answers/tags/224/windows-api-win32/"/>
    <meta name="feedback_help_link_type" content="get-help-at-qna"/>
    <meta name="UID" content="NF:aclapi.TreeResetNamedSecurityInfoW"/>
    <meta name="old-location" content="security\treeresetnamedsecurityinfo.htm"/>
    <meta name="tech.root" content="security"/>
    <meta name="ms.assetid" content="adae7d07-a452-409e-b1a1-e9f86f873e39"/>
    <meta name="ms.date" content="2018-12-05T00:00:00Z"/>
    <meta name="ms.keywords" content="TreeResetNamedSecurityInfo, TreeResetNamedSecurityInfo function [Security], TreeResetNamedSecurityInfoA, TreeResetNamedSecurityInfoW, aclapi/TreeResetNamedSecurityInfo, aclapi/TreeResetNamedSecurityInfoA, aclapi/TreeResetNamedSecurityInfoW, security.treeresetnamedsecurityinfo"/>
    <meta name="req.header" content="aclapi.h"/>
    <meta name="req.include-header" content=""/>
    <meta name="req.target-type" content="Windows"/>
    <meta name="req.target-min-winverclnt" content="Windows XP [desktop apps only]"/>
    <meta name="req.target-min-winversvr" content="Windows Server 2003 [desktop apps only]"/>
    <meta name="req.kmdf-ver" content=""/>
    <meta name="req.umdf-ver" content=""/>
    <meta name="req.ddi-compliance" content=""/>
    <meta name="req.unicode-ansi" content="TreeResetNamedSecurityInfoW (Unicode) and TreeResetNamedSecurityInfoA (ANSI)"/>
    <meta name="req.idl" content=""/>
    <meta name="req.max-support" content=""/>
    <meta name="req.namespace" content=""/>
    <meta name="req.assembly" content=""/>
    <meta name="req.type-library" content=""/>
    <meta name="req.lib" content="Advapi32.lib"/>
    <meta name="req.dll" content="Advapi32.dll"/>
    <meta name="req.irql" content=""/>
    <meta name="targetos" content="Windows"/>
    <meta name="req.typenames" content=""/>
    <meta name="req.redist" content=""/>
    <meta name="ms.custom" content="19H1"/>
    <meta name="TopicType" content="APIRef"/>
    <meta name="TopicType" content="kbSyntax"/>
    <meta name="APIType" content="DllExport"/>
    <meta name="APILocation" content="Advapi32.dll"/>
    <meta name="APILocation" content="Ext-MS-Win-AdvAPI32-ntmarta-l1-1-0.dll"/>
    <meta name="APILocation" content="advapi32legacy.dll"/>
    <meta name="APIName" content="TreeResetNamedSecurityInfo"/>
    <meta name="APIName" content="TreeResetNamedSecurityInfoA"/>
    <meta name="APIName" content="TreeResetNamedSecurityInfoW"/>
    <meta name="document_id" content="4ff66cce-dfe8-d514-47e4-3a16eee1a69c"/>
    <meta name="document_version_independent_id" content="a353c133-d60a-1ef5-b8d5-ea078e058c4e"/>
    <meta name="updated_at" content="2024-11-20T00:20:00Z"/>
    <meta name="original_content_git_url" content="https://cpubwin.visualstudio.com/DefaultCollection/win32/_git/sdk-api-build?path=/sdk-api-src/content/aclapi/nf-aclapi-treeresetnamedsecurityinfow.md&amp;version=GBlive&amp;_a=contents"/>
    <meta name="gitcommit" content="https://cpubwin.visualstudio.com/DefaultCollection/win32/_git/sdk-api-build/commit/a9040b7bd365036907a35293e28d8cd449e31b87?path=/sdk-api-src/content/aclapi/nf-aclapi-treeresetnamedsecurityinfow.md&amp;_a=contents"/>
    <meta name="git_commit_id" content="a9040b7bd365036907a35293e28d8cd449e31b87"/>
    <meta name="site_name" content="Docs"/>
    <meta name="depot_name" content="MSDN.sdk-api-build"/>
    <meta name="schema" content="Conceptual"/>
    <meta name="toc_rel" content="../_security/toc.json"/>
    <meta name="pdf_url_template" content="https://learn.microsoft.com/pdfstore/en-us/MSDN.sdk-api-build/{branchName}{pdfName}"/>
    <meta name="search.mshattr.devlang" content="c++"/>
    <meta name="word_count" content="913"/>
    <meta name="asset_id" content="aclapi/nf-aclapi-treeresetnamedsecurityinfow"/>
    <meta name="moniker_range_name" content=""/>
    <meta name="item_type" content="Content"/>
    <meta name="source_path" content="sdk-api-src/content/aclapi/nf-aclapi-treeresetnamedsecurityinfow.md"/>
    <meta name="previous_tlsh_hash" content="CF6FE6C1659E9A20F6824D4800B7E10812E491D0B690FA2422227F51A24F2DB7138129DDA56B7B4E6376027312B1E25FA5DAC73580B873BEC52848E8C4DDF575D7DCFF3AEF"/>
    <meta name="github_feedback_content_git_url" content="https://github.com/MicrosoftDocs/sdk-api/blob/docs/sdk-api-src/content/aclapi/nf-aclapi-treeresetnamedsecurityinfow.md"/>
    <meta name="cmProducts" content="https://authoring-docs-microsoft.poolparty.biz/devrel/540ac133-a371-4dbb-8f94-28d6cc77a70b" data-source="generated"/>
    <meta name="spProducts" content="https://authoring-docs-microsoft.poolparty.biz/devrel/60bfc045-f127-4841-9d00-ea35495a5800" data-source="generated"/>
    <!-- assets and js globals -->
    <link rel="stylesheet" href="/static/assets/0.4.03154.7069-f36b3c5f/styles/site-ltr.css"/>
    <link rel="preconnect" href="//mscom.demdex.net" crossorigin=""/>
    <link rel="dns-prefetch" href="//target.microsoft.com"/>
    <link rel="dns-prefetch" href="//microsoftmscompoc.tt.omtrdc.net"/>
    <link rel="preload" as="script" href="/static/third-party/adobe-target/at-js/2.9.0/at.js" integrity="sha384-1/viVM50hgc33O2gOgkWz3EjiD/Fy/ld1dKYXJRUyjNYVEjSUGcSN+iPiQF7e4cu" crossorigin="anonymous" id="adobe-target-script" type="application/javascript"/>
    <script src="https://wcpstatic.microsoft.com/mscc/lib/v2/wcp-consent.js"></script>
    <script src="https://js.monitor.azure.com/scripts/c/ms.jsll-4.min.js"></script>
    <script src="/_themes/docs.theme/master/en-us/_themes/global/deprecation.js"></script>
    <!-- msdocs global object -->
    <script id="msdocs-script">
		var msDocs = {
  "environment": {
    "accessLevel": "online",
    "azurePortalHostname": "portal.azure.com",
    "reviewFeatures": false,
    "supportLevel": "production",
    "systemContent": true,
    "siteName": "learn",
    "legacyHosting": false
  },
  "data": {
    "contentLocale": "en-us",
    "contentDir": "ltr",
    "userLocale": "en-us",
    "userDir": "ltr",
    "pageTemplate": "Conceptual",
    "brand": "",
    "context": {},
    "standardFeedback": true,
    "showFeedbackReport": false,
    "feedbackHelpLinkType": "get-help-at-qna",
    "feedbackHelpLinkUrl": "https://learn.microsoft.com/answers/tags/224/windows-api-win32/",
    "feedbackSystem": "Standard",
    "feedbackGitHubRepo": "",
    "feedbackProductUrl": "https://www.microsoft.com/en-us/windowsinsider/feedbackhub/fb",
    "extendBreadcrumb": true,
    "isEditDisplayable": true,
    "isPrivateUnauthorized": false,
    "hideViewSource": false,
    "isPermissioned": false,
    "hasRecommendations": false,
    "contributors": []
  },
  "functions": {}
};;
	</script>
    <!-- base scripts, msdocs global should be before this -->
    <script src="/static/assets/0.4.03154.7069-f36b3c5f/scripts/en-us/index-docs.js"></script>
    <!-- json-ld -->
  </head>
  <body id="body" data-bi-name="body" class="layout-body " lang="en-us" dir="ltr">
    <header class="layout-body-header">
      <div class="header-holder has-default-focus">
        <a href="#main" style="z-index: 1070" class="outline-color-text visually-hidden-until-focused position-fixed inner-focus focus-visible top-0 left-0 right-0 padding-xs text-align-center background-color-body">
			Skip to main content
		</a>
        <a href="#" data-skip-to-ask-learn="" style="z-index: 1070" class="outline-color-text visually-hidden-until-focused position-fixed inner-focus focus-visible top-0 left-0 right-0 padding-xs text-align-center background-color-body" hidden="">
			Skip to Ask Learn chat experience
		</a>
        <div hidden="" id="cookie-consent-holder" data-test-id="cookie-consent-container"></div>
        <!-- Unsupported browser warning -->
        <div id="unsupported-browser" style="background-color: white; color: black; padding: 16px; border-bottom: 1px solid grey;" hidden="">
          <div style="max-width: 800px; margin: 0 auto;">
            <p style="font-size: 24px">This browser is no longer supported.</p>
            <p style="font-size: 16px; margin-top: 16px;">
						Upgrade to Microsoft Edge to take advantage of the latest features, security updates, and technical support.
					</p>
            <div style="margin-top: 12px;">
              <a href="https://go.microsoft.com/fwlink/p/?LinkID=2092881 " style="background-color: #0078d4; border: 1px solid #0078d4; color: white; padding: 6px 12px; border-radius: 2px; display: inline-block;">
							Download Microsoft Edge
						</a>
              <a href="https://learn.microsoft.com/en-us/lifecycle/faq/internet-explorer-microsoft-edge" style="background-color: white; padding: 6px 12px; border: 1px solid #505050; color: #171717; border-radius: 2px; display: inline-block;">
							More info about Internet Explorer and Microsoft Edge
						</a>
            </div>
          </div>
        </div>
        <!-- site header -->
        <header id="ms--site-header" data-test-id="site-header-wrapper" role="banner" itemscope="itemscope" itemtype="http://schema.org/Organization">
          <div id="ms--mobile-nav" class="site-header display-none-tablet padding-inline-none gap-none" data-bi-name="mobile-header" data-test-id="mobile-header"></div>
          <div id="ms--primary-nav" class="site-header display-none display-flex-tablet" data-bi-name="L1-header" data-test-id="primary-header"></div>
          <div id="ms--secondary-nav" class="site-header display-none display-flex-tablet" data-bi-name="L2-header" data-test-id="secondary-header"></div>
        </header>
        <!-- banner -->
        <div data-banner="">
          <div id="disclaimer-holder"></div>
        </div>
        <!-- banner end -->
      </div>
    </header>
    <section id="layout-body-menu" class="layout-body-menu display-flex" data-bi-name="menu">
      <div id="left-container" class="left-container display-none display-block-tablet padding-inline-sm padding-bottom-sm width-full">
        <nav id="affixed-left-container" class="margin-top-sm-tablet position-sticky display-flex flex-direction-column" aria-label="Primary"></nav>
      </div>
    </section>
    <main id="main" role="main" class="layout-body-main " data-bi-name="content" lang="en-us" dir="ltr">
      <div id="ms--content-header" class="content-header default-focus border-bottom-none" data-bi-name="content-header">
        <div class="content-header-controls margin-xxs margin-inline-sm-tablet">
          <button type="button" class="contents-button button button-sm margin-right-xxs" data-bi-name="contents-expand" aria-haspopup="true" data-contents-button="">
            <span class="icon" aria-hidden="true">
              <span class="docon docon-menu"></span>
            </span>
            <span class="contents-expand-title"> Table of contents</span>
          </button>
          <button type="button" class="ap-collapse-behavior ap-expanded button button-sm" data-bi-name="ap-collapse" aria-controls="action-panel">
            <span class="icon" aria-hidden="true">
              <span class="docon docon-exit-mode"></span>
            </span>
            <span>Exit editor mode</span>
          </button>
        </div>
      </div>
      <div data-main-column="" class="padding-sm padding-top-none padding-top-sm-tablet">
        <div>
          <div id="article-header" class="background-color-body margin-bottom-xs display-none-print">
            <div class="display-flex align-items-center justify-content-space-between">
              <details id="article-header-breadcrumbs-overflow-popover" class="popover" data-for="article-header-breadcrumbs">
                <summary class="button button-clear button-primary button-sm inner-focus" aria-label="All breadcrumbs">
                  <span class="icon">
                    <span class="docon docon-more"></span>
                  </span>
                </summary>
                <div id="article-header-breadcrumbs-overflow" class="popover-content padding-none"></div>
              </details>
              <bread-crumbs id="article-header-breadcrumbs" data-test-id="article-header-breadcrumbs" class="overflow-hidden flex-grow-1 margin-right-sm margin-right-md-tablet margin-right-lg-desktop margin-left-negative-xxs padding-left-xxs"></bread-crumbs>
              <div id="article-header-page-actions" class="opacity-none margin-left-auto display-flex flex-wrap-no-wrap align-items-stretch">
                <button class="button button-sm border-none inner-focus display-none-tablet flex-shrink-0 " data-bi-name="ask-learn-assistant-entry" data-test-id="ask-learn-assistant-modal-entry-mobile" data-ask-learn-modal-entry="" type="button" style="min-width: max-content;" aria-expanded="false" aria-label="Ask Learn" hidden="">
                  <span class="icon font-size-lg" aria-hidden="true">
                    <span class="docon docon-chat-sparkle-fill gradient-ask-learn-logo"></span>
                  </span>
                </button>
                <button class="button button-sm display-none display-inline-flex-tablet display-none-desktop flex-shrink-0 margin-right-xxs border-color-ask-learn " data-bi-name="ask-learn-assistant-entry" data-test-id="ask-learn-assistant-modal-entry-tablet" data-ask-learn-modal-entry="" type="button" style="min-width: max-content;" aria-expanded="false" hidden="">
                  <span class="icon font-size-lg" aria-hidden="true">
                    <span class="docon docon-chat-sparkle-fill gradient-ask-learn-logo"></span>
                  </span>
                  <span>Ask Learn</span>
                </button>
                <button class="button button-sm display-none flex-shrink-0 display-inline-flex-desktop margin-right-xxs&#x9;border-color-ask-learn " data-bi-name="ask-learn-assistant-entry" data-test-id="ask-learn-assistant-flyout-entry" data-ask-learn-flyout-entry="" data-flyout-button="toggle" type="button" style="min-width: max-content;" aria-expanded="false" aria-controls="ask-learn-flyout" hidden="">
                  <span class="icon font-size-lg" aria-hidden="true">
                    <span class="docon docon-chat-sparkle-fill gradient-ask-learn-logo"></span>
                  </span>
                  <span>Ask Learn</span>
                </button>
                <button type="button" id="ms--focus-mode-button" data-focus-mode="" data-bi-name="focus-mode-entry" class="button button-sm flex-shrink-0 margin-right-xxs display-none display-inline-flex-desktop">
                  <span class="icon font-size-lg" aria-hidden="true">
                    <span class="docon docon-glasses"></span>
                  </span>
                  <span>Focus mode</span>
                </button>
                <details class="popover popover-right" id="article-header-page-actions-overflow">
                  <summary class="justify-content-flex-start button button-clear button-sm button-primary inner-focus" aria-label="More actions" title="More actions">
                    <span class="icon" aria-hidden="true">
                      <span class="docon docon-more-vertical"></span>
                    </span>
                  </summary>
                  <div class="popover-content">
                    <button data-page-action-item="overflow-mobile" type="button" class="button-block button-sm has-inner-focus button button-clear display-none-tablet justify-content-flex-start text-align-left" data-bi-name="contents-expand" data-contents-button="" data-popover-close="">
                      <span class="icon">
                        <span class="docon docon-editor-list-bullet" aria-hidden="true"></span>
                      </span>
                      <span class="contents-expand-title">Table of contents</span>
                    </button>
                    <a id="lang-link-overflow" class="button-sm has-inner-focus button button-clear button-block justify-content-flex-start text-align-left" data-bi-name="language-toggle" data-page-action-item="overflow-all" data-check-hidden="true" data-read-in-link="" href="#" hidden="">
                      <span class="icon" aria-hidden="true" data-read-in-link-icon="">
                        <span class="docon docon-locale-globe"></span>
                      </span>
                      <span data-read-in-link-text="">Read in English</span>
                    </a>
                    <button type="button" class="collection button button-clear button-sm button-block justify-content-flex-start text-align-left inner-focus" data-list-type="collection" data-bi-name="collection" data-page-action-item="overflow-all" data-check-hidden="true" data-popover-close="">
                      <span class="icon" aria-hidden="true">
                        <span class="docon docon-circle-addition"></span>
                      </span>
                      <span class="collection-status">Add</span>
                    </button>
                    <button type="button" class="collection button button-block button-clear button-sm justify-content-flex-start text-align-left inner-focus" data-list-type="plan" data-bi-name="plan" data-page-action-item="overflow-all" data-check-hidden="true" data-popover-close="" hidden="">
                      <span class="icon" aria-hidden="true">
                        <span class="docon docon-circle-addition"></span>
                      </span>
                      <span class="plan-status">Add to plan</span>
                    </button>
                    <a data-contenteditbtn="" class="button button-clear button-block button-sm inner-focus justify-content-flex-start text-align-left text-decoration-none" data-bi-name="edit" href="https://github.com/MicrosoftDocs/sdk-api/blob/docs/sdk-api-src/content/aclapi/nf-aclapi-treeresetnamedsecurityinfow.md" data-original_content_git_url="https://cpubwin.visualstudio.com/DefaultCollection/win32/_git/sdk-api-build?path=/sdk-api-src/content/aclapi/nf-aclapi-treeresetnamedsecurityinfow.md&amp;version=GBlive&amp;_a=contents" data-original_content_git_url_template="{repo}?path=/sdk-api-src/content/aclapi/nf-aclapi-treeresetnamedsecurityinfow.md&amp;version=GB{branch}&amp;_a=contents" data-pr_repo="" data-pr_branch="">
                      <span class="icon" aria-hidden="true">
                        <span class="docon docon-edit-outline"></span>
                      </span>
                      <span>Edit</span>
                    </a>
                    <hr class="margin-block-xxs"/>
                    <h4 class="font-size-sm padding-left-xxs">Share via</h4>
                    <a class="button button-clear button-sm inner-focus button-block justify-content-flex-start text-align-left text-decoration-none share-facebook" data-bi-name="facebook" data-page-action-item="overflow-all" href="#">
                      <span class="icon color-primary" aria-hidden="true">
                        <span class="docon docon-facebook-share"></span>
                      </span>
                      <span>Facebook</span>
                    </a>
                    <a href="#" class="button button-clear button-sm inner-focus button-block justify-content-flex-start text-align-left text-decoration-none share-twitter" data-bi-name="twitter" data-page-action-item="overflow-all">
                      <span class="icon color-text" aria-hidden="true">
                        <span class="docon docon-xlogo-share"></span>
                      </span>
                      <span>x.com</span>
                    </a>
                    <a href="#" class="button button-clear button-sm inner-focus button-block justify-content-flex-start text-align-left text-decoration-none share-linkedin" data-bi-name="linkedin" data-page-action-item="overflow-all">
                      <span class="icon color-primary" aria-hidden="true">
                        <span class="docon docon-linked-in-logo"></span>
                      </span>
                      <span>LinkedIn</span>
                    </a>
                    <a href="#" class="button button-clear button-sm inner-focus button-block justify-content-flex-start text-align-left text-decoration-none share-email" data-bi-name="email" data-page-action-item="overflow-all">
                      <span class="icon color-primary" aria-hidden="true">
                        <span class="docon docon-mail-message"></span>
                      </span>
                      <span>Email</span>
                    </a>
                    <hr class="margin-block-xxs"/>
                    <button class="button button-block button-clear button-sm justify-content-flex-start text-align-left inner-focus" type="button" data-bi-name="print" data-page-action-item="overflow-all" data-popover-close="" data-print-page="" data-check-hidden="true">
                      <span class="icon color-primary" aria-hidden="true">
                        <span class="docon docon-print"></span>
                      </span>
                      <span>Print</span>
                    </button>
                  </div>
                </details>
              </div>
            </div>
          </div>
          <!-- azure disclaimer -->
          <!-- privateUnauthorizedTemplate is hidden by default -->
          <div unauthorized-private-section="" data-bi-name="permission-content-unauthorized-private" hidden="">
            <hr class="hr margin-top-xs margin-bottom-sm"/>
            <div class="notification notification-info">
              <div class="notification-content">
                <p class="margin-top-none notification-title">
                  <span class="icon">
                    <span class="docon docon-exclamation-circle-solid" aria-hidden="true"></span>
                  </span>
                  <span>Note</span>
                </p>
                <p class="margin-top-none authentication-determined not-authenticated">
						Access to this page requires authorization. You can try
                  <a class="docs-sign-in" href="#" data-bi-name="permission-content-sign-in">signing in</a> or
                  <a class="docs-change-directory" data-bi-name="permisson-content-change-directory">changing directories</a>.
					
                </p>
                <p class="margin-top-none authentication-determined authenticated">
						Access to this page requires authorization. You can try
                  <a class="docs-change-directory" data-bi-name="permisson-content-change-directory">changing directories</a>.
					
                </p>
              </div>
            </div>
          </div>
          <div class="content">
            <h1 id="treeresetnamedsecurityinfow-function-aclapih">TreeResetNamedSecurityInfoW function (aclapi.h)</h1>
          </div>
          <div id="article-metadata" class="page-metadata-container display-flex gap-xxs justify-content-space-between align-items-center flex-wrap-wrap">
            <div class="margin-block-xxs">
              <ul class="metadata page-metadata" data-bi-name="page info" lang="en-us" dir="ltr">
                <li class="visibility-hidden-visual-diff">
                  <local-time format="twoDigitNumeric" datetime="2023-02-09T00:00:00.000Z" data-article-date-source="calculated" class="is-invisible">
				2023-02-09
			</local-time>
                </li>
              </ul>
            </div>
            <div id="user-feedback" class="margin-block-xxs display-none display-none-print" hidden="" data-hide-on-archived="">
              <button id="user-feedback-button" data-test-id="conceptual-feedback-button" class="button button-sm button-clear button-primary display-none" type="button" data-bi-name="user-feedback-button" data-user-feedback-button="" hidden="">
                <span class="icon" aria-hidden="true">
                  <span class="docon docon-like"></span>
                </span>
                <span>Feedback</span>
              </button>
            </div>
          </div>
          <nav id="center-doc-outline" class="doc-outline is-hidden-desktop display-none-print margin-bottom-sm" data-bi-name="intopic toc" aria-label="In this article">
            <h2 id="ms--in-this-article" class="title is-6 margin-block-xs">
				In this article
			</h2>
          </nav>
          <div class="content">
            <p>The
              <b>TreeResetNamedSecurityInfo</b> function resets specified security information in the
              <a href="/en-us/windows/desktop/SecGloss/s-gly" data-linktype="absolute-path">security descriptor</a> of a specified tree of objects. This function allows a specified
              <a href="/en-us/windows/desktop/SecGloss/d-gly" data-linktype="absolute-path">discretionary access control list</a> (DACL) or any elements in the
              <a href="/en-us/windows/desktop/SecGloss/s-gly" data-linktype="absolute-path">system access control list</a> (SACL) to be propagated throughout an entire tree. This function supports a callback function to track the progress of the tree operation.
            </p>
            <h2 id="syntax">Syntax</h2>
            <pre>
              <code class="lang-cpp">DWORD TreeResetNamedSecurityInfoW(
  [in]           LPWSTR               pObjectName,
  [in]           SE_OBJECT_TYPE       ObjectType,
  [in]           SECURITY_INFORMATION SecurityInfo,
  [in, optional] PSID                 pOwner,
  [in, optional] PSID                 pGroup,
  [in, optional] PACL                 pDacl,
  [in, optional] PACL                 pSacl,
  [in]           BOOL                 KeepExplicit,
  [in, optional] FN_PROGRESS          fnProgress,
  [in]           PROG_INVOKE_SETTING  ProgressInvokeSetting,
  [in, optional] PVOID                Args
);
</code>
            </pre>
            <h2 id="parameters">Parameters</h2>
            <p>
              <code>[in] pObjectName</code>
            </p>
            <p>Pointer to a
              <b>null</b>-terminated string that specifies the name of the root node object for the objects  that are to receive updated security information. Supported objects are registry keys and file objects. For descriptions of the string formats for the different object types, see

              <a href="/en-us/windows/desktop/api/accctrl/ne-accctrl-se_object_type" data-linktype="absolute-path">SE_OBJECT_TYPE</a>.
            </p>
            <p>
              <code>[in] ObjectType</code>
            </p>
            <p>A value of the
              <a href="/en-us/windows/desktop/api/accctrl/ne-accctrl-se_object_type" data-linktype="absolute-path">SE_OBJECT_TYPE</a>  enumeration  that indicates the type of object named by the
              <i>pObjectName</i> parameter. The supported values are SE_REGISTRY_KEY and SE_FILE_OBJECT, for registry keys and file objects, respectively.
            </p>
            <p>
              <code>[in] SecurityInfo</code>
            </p>
            <p>A set of
bit flags that indicate the type of security information to reset. This parameter can be a combination of the

              <a href="/en-us/windows/desktop/SecAuthZ/security-information" data-linktype="absolute-path">SECURITY_INFORMATION</a> bit flags.
            </p>
            <p>
              <code>[in, optional] pOwner</code>
            </p>
            <p>A pointer to a
              <a href="/en-us/windows/desktop/api/winnt/ns-winnt-sid" data-linktype="absolute-path">SID</a> structure that identifies the owner of the object. The SID must be one that can be assigned as the owner SID of a security descriptor. The
              <i>SecurityInfo</i> parameter must include the OWNER_SECURITY_INFORMATION flag. To set the owner, the caller must have WRITE_OWNER access to each object, including the root object. If you are not setting the owner SID, this parameter can be
              <b>NULL</b>.
            </p>
            <p>
              <code>[in, optional] pGroup</code>
            </p>
            <p>A pointer to a
              <a href="/en-us/windows/desktop/api/winnt/ns-winnt-sid" data-linktype="absolute-path">SID</a> structure that identifies the primary group of the object. The
              <i>SecurityInfo</i> parameter must include the GROUP_SECURITY_INFORMATION flag.  To set the group, the caller must have WRITE_OWNER access to each object, including the root object. If you are not setting the primary group SID, this parameter can be
              <b>NULL</b>.
            </p>
            <p>
              <code>[in, optional] pDacl</code>
            </p>
            <p>A pointer to an
              <a href="/en-us/windows/desktop/SecGloss/a-gly" data-linktype="absolute-path">access control list</a> (ACL) structure that represents the new DACL for the objects being reset. The
              <i>SecurityInfo</i> parameter must include the DACL_SECURITY_INFORMATION flag. The caller must have READ_CONTROL and WRITE_DAC access to each  object, including the root object. If you are not setting the DACL, this parameter can be
              <b>NULL</b>.
            </p>
            <p>
              <code>[in, optional] pSacl</code>
            </p>
            <p>A pointer to an ACL structure that represents the new SACL for the objects being reset.  The
              <i>SecurityInfo</i> parameter must include any of the following flags: SACL_SECURITY_INFORMATION, LABEL_SECURITY_INFORMATION, ATTRIBUTE_SECURITY_INFORMATION, SCOPE_SECURITY_INFORMATION, or BACKUP_SECURITY_INFORMATION. If setting SACL_SECURITY_INFORMATION or SCOPE_SECURITY_INFORMATION, the caller must have the SE_SECURITY_NAME privilege enabled. If you are not setting the SACL, this parameter can be
              <b>NULL</b>.
            </p>
            <p>
              <code>[in] KeepExplicit</code>
            </p>
            <p>Boolean value that defines whether explicitly defined ACEs are kept or deleted for the sub-tree. If
              <i>KeepExplicit</i> is
              <b>TRUE</b>, then explicitly defined ACEs are kept for each subtree DACL and SACL, and inherited ACEs are replaced by the inherited ACEs from
              <i>pDacl</i> and
              <i>pSacl</i>.  If
              <i>KeepExplicit</i> is
              <b>FALSE</b>, then explicitly defined ACEs for each subtree DACL and SACL are deleted before the inherited ACEs are replaced by the inherited ACEs from
              <i>pDacl</i> and
              <i>pSacl</i>.
            </p>
            <p>
              <code>[in, optional] fnProgress</code>
            </p>
            <p>A pointer to the function used to track the progress of the
              <b>TreeResetNamedSecurityInfo</b> function. The prototype of the progress function is:
            </p>
            <pre>
              <code class="lang-cpp">#include <windows.h>
#include <Aclapi.h>

typedef VOID (*FN_PROGRESS) (
  IN LPWSTR pObjectName,              // Name of object just processed
  IN DWORD Status,                    // Status of operation on object
  IN OUT PPROG_INVOKE_SETTING pInvokeSetting, // When to set
  IN PVOID Args,                      // Caller specific data
  IN BOOL SecuritySet                 // Whether security was set
);

</code>
            </pre>
            <p>The progress function provides the caller with progress and error information when nodes are processed. The caller specifies the progress function in
              <i>fnProgress</i>, and during the tree  operation,
              <b>TreeResetNamedSecurityInfo</b> passes the name of the last object processed, the error status of that operation, and the current  PROG_INVOKE_SETTING value. The caller can change the PROG_INVOKE_SETTING value by using
              <i>pInvokeSetting</i>.
            </p>
            <p>If no progress function is to be used, set this parameter to
              <b>NULL</b>.
            </p>
            <p>
              <code>[in] ProgressInvokeSetting</code>
            </p>
            <p>A value of the
              <a href="/en-us/windows/win32/api/accctrl/ne-accctrl-prog_invoke_setting" data-linktype="absolute-path">PROG_INVOKE_SETTING</a> enumeration that specifies the initial setting for the progress function.
            </p>
            <p>
              <code>[in, optional] Args</code>
            </p>
            <p>A pointer to a
              <b>VOID</b> for progress function arguments specified by the caller.
            </p>
            <h2 id="return-value">Return value</h2>
            <p>If the function succeeds, the function returns ERROR_SUCCESS.</p>
            <p>If the function fails, it returns an error code defined in WinError.h.</p>
            <h2 id="remarks">Remarks</h2>
            <p>Setting a
              <b>NULL</b> owner, group, DACL, or SACL is not supported by this function.
            </p>
            <p>If the caller does not contain the proper privileges and permissions to support the requested owner, group, DACL, and SACL updates, then none of the updates are performed.</p>
            <p>This function is similar to the
              <a href="/en-us/windows/desktop/api/aclapi/nf-aclapi-treesetnamedsecurityinfoa" data-linktype="absolute-path">TreeSetNamedSecurityInfo</a> function:
            </p>
            <ul>
              <li>If the
                <i>KeepExplicit</i> parameter of
                <b>TreeResetNamedSecurityInfo</b> is set to
                <b>TRUE</b>, then the function is equivalent to
                <a href="/en-us/windows/desktop/api/aclapi/nf-aclapi-treesetnamedsecurityinfoa" data-linktype="absolute-path">TreeSetNamedSecurityInfo</a> with the
                <i>dwAction</i> parameter set to  TREE_SEC_INFO_RESET_KEEP_EXPLICIT.
              </li>
              <li>If the
                <i>KeepExplicit</i> parameter of
                <b>TreeResetNamedSecurityInfo</b> is set to
                <b>FALSE</b>, then the function is equivalent to
                <a href="/en-us/windows/desktop/api/aclapi/nf-aclapi-treesetnamedsecurityinfoa" data-linktype="absolute-path">TreeSetNamedSecurityInfo</a> with the
                <i>dwAction</i> parameter set to  TREE_SEC_INFO_RESET.
              </li>
            </ul>
            <div class="NOTE">
              <p>Note</p>
              <p>The aclapi.h header defines TreeResetNamedSecurityInfo as an alias that automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that is not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see
                <a href="/en-us/windows/win32/intl/conventions-for-function-prototypes" data-linktype="absolute-path">Conventions for Function Prototypes</a>.
              </p>
            </div>
            <h2 id="requirements">Requirements</h2>
            <table>
              <thead>
                <tr>
                  <th>Requirement</th>
                  <th style="text-align: left;">Value</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>
                    <strong>Minimum supported client</strong>
                  </td>
                  <td style="text-align: left;">Windows XP [desktop apps only]</td>
                </tr>
                <tr>
                  <td>
                    <strong>Minimum supported server</strong>
                  </td>
                  <td style="text-align: left;">Windows Server 2003 [desktop apps only]</td>
                </tr>
                <tr>
                  <td>
                    <strong>Target Platform</strong>
                  </td>
                  <td style="text-align: left;">Windows</td>
                </tr>
                <tr>
                  <td>
                    <strong>Header</strong>
                  </td>
                  <td style="text-align: left;">aclapi.h</td>
                </tr>
                <tr>
                  <td>
                    <strong>Library</strong>
                  </td>
                  <td style="text-align: left;">Advapi32.lib</td>
                </tr>
                <tr>
                  <td>
                    <strong>DLL</strong>
                  </td>
                  <td style="text-align: left;">Advapi32.dll</td>
                </tr>
              </tbody>
            </table>
          </div>
          <div id="ms--inline-notifications" class="margin-block-xs" data-bi-name="inline-notification"></div>
          <div id="assertive-live-region" role="alert" aria-live="assertive" class="visually-hidden" aria-relevant="additions" aria-atomic="true"></div>
          <div id="polite-live-region" role="status" aria-live="polite" class="visually-hidden" aria-relevant="additions" aria-atomic="true"></div>
          <!-- feedback section -->
          <section id="site-user-feedback-footer" class="font-size-sm margin-top-md display-none-print display-none-desktop" data-test-id="site-user-feedback-footer" data-bi-name="site-feedback-section">
            <hr class="hr"/>
            <h2 id="ms--feedback" class="title is-3">Feedback</h2>
            <div class="display-flex flex-wrap-wrap align-items-center">
              <p class="font-weight-semibold margin-xxs margin-left-none">
					Was this page helpful?
				</p>
              <div class="buttons">
                <button class="thumb-rating-button like button button-primary button-sm" data-test-id="footer-rating-yes" data-binary-rating-response="rating-yes" type="button" title="This article is helpful" data-bi-name="button-rating-yes" aria-pressed="false">
                  <span class="icon" aria-hidden="true">
                    <span class="docon docon-like"></span>
                  </span>
                  <span>Yes</span>
                </button>
                <button class="thumb-rating-button dislike button button-primary button-sm" data-test-id="footer-rating-no" data-binary-rating-response="rating-no" type="button" title="This article is not helpful" data-bi-name="button-rating-no" aria-pressed="false">
                  <span class="icon" aria-hidden="true">
                    <span class="docon docon-dislike"></span>
                  </span>
                  <span>No</span>
                </button>
              </div>
            </div>
          </section>
          <!-- end feedback section -->
        </div>
        <div id="ms--additional-resources-mobile" class="display-none-print">
          <hr class="hr" hidden=""/>
          <h2 id="ms--additional-resources-mobile-heading" class="title is-3" hidden="">
				Additional resources
			</h2>
          <section id="right-rail-training-mobile" class="" data-bi-name="learning-resource-card" hidden=""></section>
          <section id="right-rail-events-mobile" class="" data-bi-name="events-card" hidden=""></section>
          <section id="right-rail-qna-mobile" class="margin-top-xxs" data-bi-name="qna-link-card" hidden=""></section>
        </div>
      </div>
      <div id="action-panel" role="region" aria-label="Action Panel" class="action-panel" tabindex="-1"></div>
    </main>
    <aside id="layout-body-aside" class="layout-body-aside " data-bi-name="aside">
      <div id="ms--additional-resources" class="right-container padding-sm display-none display-block-desktop height-full" data-bi-name="pageactions" role="complementary" aria-label="Additional resources">
        <div id="affixed-right-container" data-bi-name="right-column">
          <nav id="side-doc-outline" class="doc-outline border-bottom padding-bottom-xs margin-bottom-xs" data-bi-name="intopic toc" aria-label="In this article">
            <h3>In this article</h3>
          </nav>
          <!-- Feedback -->
          <section id="ms--site-user-feedback-right-rail" class="font-size-sm display-none-print" data-test-id="site-user-feedback-right-rail" data-bi-name="site-feedback-right-rail">
            <p class="font-weight-semibold margin-bottom-xs">Was this page helpful?</p>
            <div class="buttons">
              <button class="thumb-rating-button like button button-primary button-sm" data-test-id="right-rail-rating-yes" data-binary-rating-response="rating-yes" type="button" title="This article is helpful" data-bi-name="button-rating-yes" aria-pressed="false">
                <span class="icon" aria-hidden="true">
                  <span class="docon docon-like"></span>
                </span>
                <span>Yes</span>
              </button>
              <button class="thumb-rating-button dislike button button-primary button-sm" data-test-id="right-rail-rating-no" data-binary-rating-response="rating-no" type="button" title="This article is not helpful" data-bi-name="button-rating-no" aria-pressed="false">
                <span class="icon" aria-hidden="true">
                  <span class="docon docon-dislike"></span>
                </span>
                <span>No</span>
              </button>
            </div>
          </section>
        </div>
      </div>
    </aside>
    <section id="layout-body-flyout" class="layout-body-flyout " data-bi-name="flyout">
      <div class="height-full border-left background-color-body-medium" id="ask-learn-flyout"></div>
    </section>
    <div class="layout-body-footer " data-bi-name="layout-footer">
      <footer id="footer" data-test-id="footer" data-bi-name="footer" class="footer-layout has-padding has-default-focus border-top  uhf-container" role="contentinfo">
        <div class="display-flex gap-xs flex-wrap-wrap is-full-height padding-right-lg-desktop">
          <a data-mscc-ic="false" href="#" data-bi-name="select-locale" class="locale-selector-link flex-shrink-0 button button-sm button-clear external-link-indicator" id="" title="">
            <span class="icon" aria-hidden="true">
              <span class="docon docon-world"></span>
            </span>
            <span class="local-selector-link-text">en-us</span>
          </a>
          <div class="ccpa-privacy-link" data-ccpa-privacy-link="" hidden="">
            <a data-mscc-ic="false" href="https://aka.ms/yourcaliforniaprivacychoices" data-bi-name="your-privacy-choices" class="button button-sm button-clear flex-shrink-0 external-link-indicator" id="" title="">
              <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 30 14" xml:space="preserve" height="16" width="43" aria-hidden="true" focusable="false">
                <path d="M7.4 12.8h6.8l3.1-11.6H7.4C4.2 1.2 1.6 3.8 1.6 7s2.6 5.8 5.8 5.8z" style="fill-rule:evenodd;clip-rule:evenodd;fill:#fff"></path>
                <path d="M22.6 0H7.4c-3.9 0-7 3.1-7 7s3.1 7 7 7h15.2c3.9 0 7-3.1 7-7s-3.2-7-7-7zm-21 7c0-3.2 2.6-5.8 5.8-5.8h9.9l-3.1 11.6H7.4c-3.2 0-5.8-2.6-5.8-5.8z" style="fill-rule:evenodd;clip-rule:evenodd;fill:#06f"></path>
                <path d="M24.6 4c.2.2.2.6 0 .8L22.5 7l2.2 2.2c.2.2.2.6 0 .8-.2.2-.6.2-.8 0l-2.2-2.2-2.2 2.2c-.2.2-.6.2-.8 0-.2-.2-.2-.6 0-.8L20.8 7l-2.2-2.2c-.2-.2-.2-.6 0-.8.2-.2.6-.2.8 0l2.2 2.2L23.8 4c.2-.2.6-.2.8 0z" style="fill:#fff"></path>
                <path d="M12.7 4.1c.2.2.3.6.1.8L8.6 9.8c-.1.1-.2.2-.3.2-.2.1-.5.1-.7-.1L5.4 7.7c-.2-.2-.2-.6 0-.8.2-.2.6-.2.8 0L8 8.6l3.8-4.5c.2-.2.6-.2.9 0z" style="fill:#06f"></path>
              </svg>
              <span>Your Privacy Choices</span>
            </a>
          </div>
          <div class="flex-shrink-0">
            <div class="dropdown has-caret-up">
              <button data-test-id="theme-selector-button" class="dropdown-trigger button button-clear button-sm has-inner-focus theme-dropdown-trigger" aria-controls="{{ themeMenuId }}" aria-expanded="false" title="Theme" data-bi-name="theme">
                <span class="icon">
                  <span class="docon docon-sun" aria-hidden="true"></span>
                </span>
                <span>Theme</span>
                <span class="icon expanded-indicator" aria-hidden="true">
                  <span class="docon docon-chevron-down-light"></span>
                </span>
              </button>
              <div class="dropdown-menu" id="{{ themeMenuId }}" role="menu">
                <ul class="theme-selector padding-xxs" data-test-id="theme-dropdown-menu">
                  <li class="theme display-block">
                    <button class="button button-clear button-sm theme-control button-block justify-content-flex-start text-align-left" data-theme-to="light">
                      <span class="theme-light margin-right-xxs">
                        <span class="theme-selector-icon border display-inline-block has-body-background" aria-hidden="true">
                          <svg class="svg" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 22 14">
                            <rect width="22" height="14" class="has-fill-body-background"/>
                            <rect x="5" y="5" width="12" height="4" class="has-fill-secondary"/>
                            <rect x="5" y="2" width="2" height="1" class="has-fill-secondary"/>
                            <rect x="8" y="2" width="2" height="1" class="has-fill-secondary"/>
                            <rect x="11" y="2" width="3" height="1" class="has-fill-secondary"/>
                            <rect x="1" y="1" width="2" height="2" class="has-fill-secondary"/>
                            <rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary"/>
                            <rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary"/></svg>
                        </span>
                      </span>
                      <span role="menuitem"> Light</span>
                    </button>
                  </li>
                  <li class="theme display-block">
                    <button class="button button-clear button-sm theme-control button-block justify-content-flex-start text-align-left" data-theme-to="dark">
                      <span class="theme-dark margin-right-xxs">
                        <span class="border theme-selector-icon display-inline-block has-body-background" aria-hidden="true">
                          <svg class="svg" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 22 14">
                            <rect width="22" height="14" class="has-fill-body-background"/>
                            <rect x="5" y="5" width="12" height="4" class="has-fill-secondary"/>
                            <rect x="5" y="2" width="2" height="1" class="has-fill-secondary"/>
                            <rect x="8" y="2" width="2" height="1" class="has-fill-secondary"/>
                            <rect x="11" y="2" width="3" height="1" class="has-fill-secondary"/>
                            <rect x="1" y="1" width="2" height="2" class="has-fill-secondary"/>
                            <rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary"/>
                            <rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary"/></svg>
                        </span>
                      </span>
                      <span role="menuitem"> Dark</span>
                    </button>
                  </li>
                  <li class="theme display-block">
                    <button class="button button-clear button-sm theme-control button-block justify-content-flex-start text-align-left" data-theme-to="high-contrast">
                      <span class="theme-high-contrast margin-right-xxs">
                        <span class="border theme-selector-icon display-inline-block has-body-background" aria-hidden="true">
                          <svg class="svg" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 22 14">
                            <rect width="22" height="14" class="has-fill-body-background"/>
                            <rect x="5" y="5" width="12" height="4" class="has-fill-secondary"/>
                            <rect x="5" y="2" width="2" height="1" class="has-fill-secondary"/>
                            <rect x="8" y="2" width="2" height="1" class="has-fill-secondary"/>
                            <rect x="11" y="2" width="3" height="1" class="has-fill-secondary"/>
                            <rect x="1" y="1" width="2" height="2" class="has-fill-secondary"/>
                            <rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary"/>
                            <rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary"/></svg>
                        </span>
                      </span>
                      <span role="menuitem"> High contrast</span>
                    </button>
                  </li>
                </ul>
              </div>
            </div>
          </div>
        </div>
        <ul class="links" data-bi-name="footerlinks">
          <li class="manage-cookies-holder" hidden=""></li>
          <li>
            <a data-mscc-ic="false" href="https://learn.microsoft.com/en-us/principles-for-ai-generated-content" data-bi-name="aiDisclaimer" class=" external-link-indicator" id="" title="">AI Disclaimer</a>
          </li>
          <li>
            <a data-mscc-ic="false" href="https://learn.microsoft.com/en-us/previous-versions/" data-bi-name="archivelink" class=" external-link-indicator" id="" title="">Previous Versions</a>
          </li>
          <li>
            <a data-mscc-ic="false" href="https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog" data-bi-name="bloglink" class=" external-link-indicator" id="" title="">Blog</a>
          </li>
          <li>
            <a data-mscc-ic="false" href="https://learn.microsoft.com/en-us/contribute" data-bi-name="contributorGuide" class=" external-link-indicator" id="" title="">Contribute</a>
          </li>
          <li>
            <a data-mscc-ic="false" href="https://go.microsoft.com/fwlink/?LinkId=521839" data-bi-name="privacy" class=" external-link-indicator" id="" title="">Privacy</a>
          </li>
          <li>
            <a data-mscc-ic="false" href="https://learn.microsoft.com/en-us/legal/termsofuse" data-bi-name="termsofuse" class=" external-link-indicator" id="" title="">Terms of Use</a>
          </li>
          <li>
            <a data-mscc-ic="false" href="https://www.microsoft.com/legal/intellectualproperty/Trademarks/" data-bi-name="trademarks" class=" external-link-indicator" id="" title="">Trademarks</a>
          </li>
          <li>© Microsoft 2025</li>
        </ul>
      </footer>
    </footer>
  </body>
</html>
